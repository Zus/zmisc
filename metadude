makeMetaAnalysisDialog <- function(){
	#make dialog
	dialog <- new(SimpleRDialog)
	dialog$setSize(500L,400L)
	dialog$setTitle("Meta-Analysis")

	#add variable selector
	variableSelector <- new(VariableSelectorWidget)
	variableSelector$setTitle("data")
	addComponent(dialog,variableSelector,10,400,850,10)

	#add variable selector
	var1<- new(SingleVariableWidget,variableSelector)
	var1$setTitle("Variable for event in control")
	addComponent(dialog, var1,500,900,150, 120)

#add variable selector
	var2<- new(SingleVariableWidget,variableSelector)
	var2$setTitle("Variable for event in control")
	addComponent(dialog, var2,500,900,200, 420)
	
	#add variable selector
	var3<- new(SingleVariableWidget,variableSelector)
	var3$setTitle("Variable for event in control")
	addComponent(dialog, var3,100,900,100, 420)
#add a list for the variables
	#variableList<- new(VariableListWidget,variableSelector)
	#variableList$setTitle("variables")
	#addComponent(dialog, variableList,100,900,450, 420)

	#options for transforming the variables
	#transBoxes <- new(CheckBoxesWidget,"Transformation",c("Center","Scale"))
	#addComponent(dialog, transBoxes,500,900,670, 540)
	#transBoxes$setDefaultModel(c("Scale"))

	#output options
	#outBoxes <- new(CheckBoxesWidget,"Output",c("Summary","Scree Plot"))
	#addComponent(dialog, outBoxes,680,900,850, 540)
	
	dialog$setCheckFunction(".metaAnalysisCheckFunction")
	dialog$setRunFunction(".metaAnalysisRunFunction")
	return(dialog)
}

.metaAnalysisCheckFunction <- function(state){
	#make sure at least two variables are selected
	if(length(state$variables)<1)
		return("Please select at least one variables")
	return("")
}

.metaAnalysisRunFunction <- function(state){
	print(state) #a print statement is useful for debugging
	#output summary and plot if asked for
	if("Summary" %in% state$Output)
		#cmd <- paste(cmd,"\n","summary(pr.model)")
	if("Scree Plot" %in% state$Output)
		#cmd <- paste(cmd,"\n","screeplot(pr.model)")

	#execute command as if typed into console
	execute(cmd)
}



.onLoad <- function(libname, pkgname) { 
	.registerDialog("Run Meta", makeMetaAnalysisDialog)
	deducer.addMenu("Example")
	deducer.addMenuItem("Run Meta",,".getDialog('Run Meta')$run()","Example")
		if(.windowsGUI){
		winMenuAdd("Meta-Analysis")
		winMenuAddItem("Meta-Analysis", "Run Meta-Analysis", "deducer('Meta-Analysis')")
	}else if(.jgr){
		jgr.addMenu("Example")
		jgr.addMenuItem("Example", "Run Meta", "deducer('Run Meta')")
	}

}
